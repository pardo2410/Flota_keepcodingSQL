-- Flota de Vehiculos Keepcoding
-- Juan David Pardo 

-- Creamos el Esquema

create schema flota_keepcoding;

-- A continuación, creamos todas las tablas con sus claves primarias

create table flota_keepcoding.vehiculos (
	id serial primary key,
	matricula varchar (30) not null,
	num_chasis varchar(30) not null,
	kilometros numeric not null,
	fecha_adquisicion date not null,
	id_grupo int not null,
	id_color int not null
);

create table flota_keepcoding.grupo (
	id_grupo serial primary key,
	nombre_grupo varchar (60) not null,
	id_marca int not null
);

create table flota_keepcoding.marca (
	id_marca serial primary key,
	nombre_marca varchar (30) not null,
	id_modelo int not null
);

create table flota_keepcoding.modelo (
	id_modelo serial primary key,
	nombre_modelo varchar (30) not null
);

create table flota_keepcoding.color (
	id_color serial primary key,
	nombre_color varchar (30) not null
);

create table flota_keepcoding.compania_aseguradora (
	id_aseguradora serial primary key,
	nombre_aseguradora varchar (30) not null,
	id_poliza int not null,
	id_vehiculo int not null
);

create table flota_keepcoding.poliza (
	id_poliza serial primary key,
	num_poliza numeric not null,
	nombre_poliza varchar (30) not null,
	inicio_cobertura date not null,
	vigencia_poliza boolean not null
);

create table flota_keepcoding.mantenimientos (
	id_mantenimientos serial primary key,
	id_vehiculo int not null,
	kilometraje numeric not null,
	fecha_revision date not null,
	valor_importe numeric not null,
	id_moneda int not null
);

create table  flota_keepcoding.moneda (
	id_moneda serial primary key,
	nombre varchar(30) not null
);

-- Una vez creadas las tablas, podemos proceder a crear las relaciones

alter table flota_keepcoding.vehiculos add constraint pk_vehiculos_grupo foreign key (id_grupo) references flota_keepcoding.grupo(id_grupo);
alter table flota_keepcoding.grupo add constraint pk_grupo_marca foreign key (id_marca) references flota_keepcoding.marca(id_marca);
alter table flota_keepcoding.vehiculos add constraint pk_vehiculos_color foreign key (id_color) references flota_keepcoding.color(id_color);
alter table flota_keepcoding.compania_aseguradora add constraint pk_compania_aseguradora_piliza foreign key (id_poliza) references flota_keepcoding.poliza(id_poliza);
alter table flota_keepcoding.mantenimientos add constraint pk_mantenimientos_moneda foreign key (id_moneda) references flota_keepcoding.moneda(id_moneda);
alter table flota_keepcoding.marca add constraint pk_marca_modelo foreign key (id_modelo) references flota_keepcoding.modelo(id_modelo);
alter table flota_keepcoding.compania_aseguradora add constraint pk_compania_aseguradora_vehiculos foreign key (id_vehiculo) references flota_keepcoding.vehiculos(id);
alter table flota_keepcoding.mantenimientos add constraint pk_mantenimientos_vehiculos foreign key (id_vehiculo) references flota_keepcoding.vehiculos(id);


-- Ahora cargamos todos los datos:

insert into flota_keepcoding.color (nombre_color) 
select distinct nombre_color 
from( 
	values ('Rojo'),	('Gris Plateado'),	('Gris Plateado'),	('Blanco'),	('Blanco'),	('Blanco'),	('Negro'),	('Negro'),	('Negro'),	('Negro'),	('Negro'),	('Blanco'),	('Blanco'),	('Blanco'),	('Rojo'),	('Rojo'),	('Rojo'),	('Rojo'),	('Gris Plateado'),	('Negro'),	('Negro'),	('Rojo'),	('Negro'),	('Gris Plateado'),	('Gris Plateado'),	('Rojo'),	('Verde'),	('Verde'),	('Verde'),	('Verde'),	('Verde'),	('Verde'),	('Gris Plateado'),	('Gris Plateado'),	('Blanco'),	('Blanco'),	('Blanco'),	('Verde'),	('Blanco'),	('Blanco'),	('Blanco'),	('Negro'),	('Blanco'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Negro'),	('Verde'),	('Verde'),	('Verde'),	('Verde'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Verde'),	('Gris Plateado'),	('Blanco'),	('Negro'),	('Negro'),	('Negro'),	('Verde'),	('Verde'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Blanco'),	('Gris Plateado'),	('Gris Plateado'),	('Negro'),	('Negro'),	('Verde'),	('Azul'),	('Azul'),	('Verde'),	('Rojo'),	('Verde'),	('Verde'),	('Rojo'),	('Verde'),	('Negro'),	('Verde'),	('Verde'),	('Verde'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Verde'),	('Blanco'),	('Negro'),	('Rojo'),	('Rojo'),	('Negro'),	('Negro'),	('Negro'),	('Negro'),	('Negro'),	('Negro'),	('Gris Plateado'),	('Rojo'),	('Verde'),	('Verde'),	('Azul'),	('Negro'),	('Rojo'),	('Gris Plateado'),	('Blanco'),	('Azul'),	('Azul'),	('Negro'),	('Azul'),	('Azul'),	('Blanco'),	('Negro'),	('Negro'),	('Negro'),	('Gris Plateado'),	('Rojo'),	('Azul'),	('Azul'),	('Azul'),	('Verde'),	('Gris Plateado'),	('Verde'),	('Gris Plateado'),	('Verde'),	('Verde'),	('Rojo'),	('Rojo'),	('Rojo'),	('Negro'),	('Verde'),	('Rojo'),	('Rojo'),	('Azul'),	('Azul'),	('Azul'),	('Verde'),	('Verde'),	('Blanco'),	('Rojo'),	('Rojo'),	('Negro'),	('Azul'),	('Blanco'),	('Negro'),	('Rojo'),	('Rojo'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Gris Plateado'),	('Azul'),	('Rojo'),	('Blanco')
) as valores(nombre_color);

insert into flota_keepcoding.moneda (nombre) 
select distinct nombre 
from( 
	values ('Peso Colombiano'),	('Dólar'),	('Euro'),	('Peso Colombiano'),	('Peso Colombiano'),	('Euro'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Euro'),	('Peso Mexicano'),	('Euro'),	('Dólar'),	('Euro'),	('Peso Mexicano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Dólar'),	('Peso Colombiano'),	('Dólar'),	('Euro'),	('Peso Mexicano'),	('Euro'),	('Peso Mexicano'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Peso Colombiano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Dólar'),	('Peso Mexicano'),	('Dólar'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Peso Colombiano'),	('Dólar'),	('Euro'),	('Dólar'),	('Peso Mexicano'),	('Euro'),	('Dólar'),	('Dólar'),	('Dólar'),	('Dólar'),	('Euro'),	('Euro'),	('Dólar'),	('Peso Mexicano'),	('Peso Mexicano'),	('Euro'),	('Peso Colombiano'),	('Peso Colombiano'),	('Euro'),	('Peso Colombiano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Peso Colombiano'),	('Dólar'),	('Peso Colombiano'),	('Dólar'),	('Peso Colombiano'),	('Dólar'),	('Dólar'),	('Euro'),	('Peso Mexicano'),	('Dólar'),	('Peso Mexicano'),	('Euro'),	('Dólar'),	('Euro'),	('Peso Colombiano'),	('Peso Mexicano'),	('Peso Colombiano'),	('Peso Mexicano'),	('Peso Mexicano'),	('Dólar'),	('Euro'),	('Dólar'),	('Peso Colombiano'),	('Dólar'),	('Peso Colombiano'),	('Peso Colombiano'),	('Euro'),	('Dólar'),	('Euro'),	('Peso Mexicano'),	('Peso Mexicano'),	('Dólar'),	('Peso Mexicano'),	('Euro'),	('Peso Colombiano'),	('Euro'),	('Peso Colombiano'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Peso Mexicano'),	('Euro'),	('Euro'),	('Peso Colombiano'),	('Euro'),	('Peso Mexicano'),	('Dólar'),	('Peso Colombiano'),	('Peso Mexicano'),	('Euro'),	('Dólar'),	('Euro'),	('Euro'),	('Euro'),	('Euro'),	('Euro'),	('Peso Colombiano'),	('Euro'),	('Euro'),	('Peso Mexicano'),	('Euro'),	('Peso Colombiano'),	('Dólar'),	('Peso Colombiano'),	('Peso Colombiano'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Dólar'),	('Peso Colombiano'),	('Peso Colombiano'),	('Peso Mexicano'),	('Euro'),	('Peso Colombiano'),	('Peso Colombiano'),	('Dólar'),	('Peso Colombiano'),	('Euro'),	('Peso Mexicano'),	('Euro'),	('Peso Colombiano'),	('Dólar'),	('Peso Mexicano'),	('Dólar'),	('Peso Mexicano'),	('Euro'),	('Euro'),	('Peso Colombiano'),	('Peso Colombiano'),	('Euro'),	('Dólar'),	('Dólar'),	('Euro'),	('Dólar'),	('Peso Mexicano'),	('Peso Colombiano'),	('Dólar')
) as valores(nombre);

insert into flota_keepcoding.modelo (nombre_modelo) 
select distinct nombre_modelo 
from( 
	values ('Clio'),	('DS4'),	('DS4'),	('Leaf'),	('Ceed'),	('Ceed'),	('206'),	('206'),	('206'),	('206'),	('Qashqai'),	('Rio'),	('DS4'),	('Clio'),	('Megane'),	('Megane'),	('Megane'),	('Megane'),	('Duster'),	('Ceed'),	('Ceed'),	('Duster'),	('Qashqai'),	('Ceed'),	('Rio'),	('DS4'),	('Tucson'),	('Tucson'),	('Tucson'),	('Leaf'),	('Leaf'),	('Leaf'),	('DS4'),	('Megane'),	('DS4'),	('DS4'),	('DS4'),	('Tucson'),	('i30'),	('i30'),	('i30'),	('Qashqai'),	('Berlingo'),	('5008'),	('5008'),	('5008'),	('5008'),	('i30'),	('Megane'),	('Megane'),	('Megane'),	('Megane'),	('Rio'),	('Rio'),	('Rio'),	('Tucson'),	('Ceed'),	('Duster'),	('5008'),	('5008'),	('5008'),	('i30'),	('i30'),	('Clio'),	('Clio'),	('Clio'),	('Tucson'),	('Tucson'),	('Tucson'),	('Qashqai'),	('Qashqai'),	('206'),	('Rio'),	('Rio'),	('Rio'),	('206'),	('Ceed'),	('Ceed'),	('DS4'),	('Ceed'),	('DS4'),	('Megane'),	('Megane'),	('Megane'),	('Ceed'),	('Berlingo'),	('Berlingo'),	('Clio'),	('Clio'),	('Clio'),	('DS4'),	('Ceed'),	('Kangoo'),	('5008'),	('5008'),	('Kangoo'),	('Kangoo'),	('Kangoo'),	('Kangoo'),	('DS4'),	('Ceed'),	('Tucson'),	('5008'),	('Tucson'),	('Tucson'),	('i30'),	('Qashqai'),	('Ceed'),	('i30'),	('Duster'),	('Leaf'),	('i30'),	('Qashqai'),	('Leaf'),	('5008'),	('i30'),	('Berlingo'),	('Berlingo'),	('Berlingo'),	('i30'),	('Kangoo'),	('Qashqai'),	('Qashqai'),	('Qashqai'),	('Tucson'),	('Lodgy'),	('Rio'),	('Tucson'),	('Duster'),	('Duster'),	('i30'),	('i30'),	('i30'),	('DS4'),	('Qashqai'),	('Tucson'),	('Kangoo'),	('i30'),	('i30'),	('i30'),	('Tucson'),	('Tucson'),	('206'),	('Kangoo'),	('Kangoo'),	('Qashqai'),	('Tucson'),	('Duster'),	('5008'),	('Leaf'),	('DS4'),	('5008'),	('5008'),	('5008'),	('5008'),	('i30'),	('206'),	('Rio')
) as valores(nombre_modelo);

insert into flota_keepcoding.poliza (num_poliza, nombre_poliza, inicio_cobertura, vigencia_poliza) 
values (25786,'Esencial','2009/06/01',true),	(195443,'Esencial','2010/04/17',true),	(110761,'Basico','2011/08/23',true),	(79841,'Basico','2008/03/03',true),	(112320,'Amplio Plus','1999/09/30',true),	(135515,'Esencial','2001/04/05',true),	(142266,'Amplio Plus','2011/07/19',true),	(142266,'Amplio','2011/07/19',true),	(142266,'Basico','2011/07/19',true),	(159753,'Basico','2012/10/22',true),	(67577,'Esencial','2017/10/10',true),	(32844,'Amplio','2009/01/23',true),	(12534,'Basico','2020/04/13',true),	(54632,'Amplio','2007/02/27',true),	(183813,'Basico','2013/03/06',true),	(183813,'Basico','2013/03/06',true),	(183813,'Basico','2013/03/06',true),	(187526,'Basico','2014/07/14',true),	(9482,'Amplio Plus','2017/08/27',true),	(144573,'Amplio','2015/04/01',true),	(186297,'Esencial','2016/08/24',true),	(34218,'Amplio','2019/04/10',true),	(35103,'Basico','2000/11/24',true),	(41930,'Basico','2006/03/04',false),	(117277,'Amplio','2015/12/19',false),	(85225,'Basico','2013/04/01',false),	(151249,'Amplio Plus','2010/04/21',true),	(151249,'Esencial','2010/04/21',true),	(169829,'Esencial','2011/12/01',true),	(174969,'Esencial','2011/12/19',true),	(174969,'Esencial','2011/12/19',true),	(173030,'Basico','2013/02/18',true),	(79203,'Amplio','2007/08/30',true),	(40647,'Amplio','2006/07/24',true),	(172625,'Amplio Plus','2009/10/26',false),	(172625,'Amplio Plus','2009/10/26',true),	(161701,'Esencial','2010/10/16',true),	(40977,'Basico','2013/11/03',true),	(170914,'Esencial','2004/09/22',true),	(170914,'Esencial','2004/09/22',true),	(172754,'Amplio Plus','2006/03/23',true),	(121919,'Esencial','2008/08/21',true),	(96770,'Basico','2017/09/18',true),	(172546,'Amplio Plus','2003/04/10',true),	(172546,'Amplio','2003/04/10',true),	(172546,'Amplio Plus','2003/04/10',true),	(111429,'Esencial','2004/05/29',true),	(92532,'Basico','2012/11/08',true),	(181054,'Amplio Plus','2014/12/04',true),	(181054,'Esencial','2014/12/04',true),	(181054,'Basico','2014/12/04',true),	(161471,'Esencial','2015/10/15',true),	(116336,'Basico','2007/06/25',true),	(116336,'Amplio','2007/06/25',true),	(116398,'Amplio Plus','2008/09/16',true),	(91503,'Esencial','2008/05/16',true),	(19347,'Amplio','2016/12/03',true),	(167291,'Amplio','2014/05/02',true),	(104210,'Basico','2017/07/06',true),	(104210,'Amplio Plus','2017/07/06',true),	(182094,'Amplio','2019/01/02',true),	(173686,'Amplio','2016/03/07',true),	(191842,'Basico','2017/08/09',true),	(119373,'Basico','2016/11/27',true),	(119373,'Basico','2016/11/27',true),	(192389,'Basico','2018/04/19',true),	(51353,'Esencial','2008/04/02',true),	(163498,'Amplio','2015/10/24',true),	(105002,'Amplio','2016/10/04',true),	(146739,'Amplio Plus','2019/04/16',true),	(127909,'Amplio Plus','2020/09/18',true),	(190446,'Amplio Plus','2015/09/03',true),	(174298,'Basico','2018/03/19',true),	(109846,'Basico','2019/03/11',true),	(89739,'Amplio','2018/06/03',true),	(124027,'Amplio','2012/04/19',true),	(189152,'Basico','2016/04/14',true),	(117439,'Esencial','2017/11/21',true),	(89394,'Esencial','2004/10/12',true),	(96367,'Basico','2002/11/12',true),	(82043,'Amplio','2007/01/31',true),	(184039,'Esencial','2020/09/06',true),	(184039,'Amplio Plus','2020/09/06',true),	(131978,'Basico','2021/12/21',true),	(16848,'Amplio Plus','2006/07/13',true),	(105112,'Amplio Plus','1999/03/14',true),	(126373,'Amplio','2000/01/12',true),	(145462,'Amplio Plus','2007/03/31',true),	(145462,'Esencial','2007/03/31',true),	(190418,'Amplio Plus','2008/05/10',true),	(121129,'Amplio Plus','2008/05/01',true),	(66942,'Esencial','2020/05/11',true),	(8307,'Basico','2017/09/15',true),	(174043,'Esencial','2020/03/02',true),	(118686,'Basico','2021/09/02',true),	(172309,'Basico','2006/01/22',true),	(172309,'Amplio Plus','2006/01/22',true),	(172309,'Amplio','2006/01/22',true),	(176268,'Esencial','2007/01/07',true),	(50387,'Basico','2008/05/10',true),	(117329,'Amplio Plus','2018/06/05',true),	(88106,'Basico','2002/04/06',true),	(73097,'Basico','2007/08/02',true),	(139949,'Amplio Plus','2003/03/02',true),	(126578,'Basico','2004/01/30',true),	(56264,'Esencial','2015/10/31',true),	(39780,'Amplio','2004/03/13',true),	(4341,'Amplio','2008/07/30',true),	(64092,'Esencial','2001/03/14',true),	(113718,'Amplio Plus','2008/11/19',true),	(55403,'Amplio Plus','2006/10/17',true),	(115392,'Amplio Plus','2002/01/17',true),	(20640,'Basico','2005/08/23',true),	(84213,'Esencial','2017/10/11',true),	(85627,'Amplio Plus','2008/02/12',true),	(7094,'Amplio Plus','2007/11/15',true),	(118284,'Amplio','2008/06/23',true),	(118284,'Amplio Plus','2008/06/23',true),	(137325,'Amplio Plus','2009/10/14',true),	(73547,'Amplio','2004/06/21',true),	(124038,'Amplio','2002/12/12',true),	(136600,'Amplio Plus','2015/03/29',true),	(136600,'Amplio Plus','2015/03/29',true),	(163789,'Amplio Plus','2016/01/31',true),	(187586,'Basico','2004/05/18',true),	(54681,'Amplio Plus','2008/04/29',true),	(131987,'Amplio','2015/10/03',true),	(71232,'Amplio Plus','2007/03/13',true),	(190383,'Amplio Plus','1999/06/06',true),	(177717,'Amplio','2000/05/01',true),	(196487,'Amplio','2019/01/14',true),	(196487,'Esencial','2019/01/14',true),	(189761,'Amplio','2020/08/03',true),	(63946,'Amplio','2011/09/17',true),	(62061,'Esencial','2004/01/15',true),	(94565,'Amplio Plus','2003/04/08',true),	(82585,'Basico','2014/10/11',true),	(161477,'Amplio','2007/12/07',true),	(161477,'Amplio Plus','2007/12/07',true),	(157749,'Esencial','2009/03/12',true),	(125045,'Amplio Plus','2012/10/01',true),	(136882,'Amplio','2014/01/28',true),	(6062,'Amplio Plus','2001/02/09',true),	(144448,'Esencial','2016/11/16',true),	(108872,'Amplio','2018/05/12',true),	(8576,'Amplio','2014/05/19',true),	(86600,'Amplio Plus','2016/01/24',true),	(26976,'Amplio Plus','2012/09/29',true),	(48113,'Amplio Plus','2008/04/29',false),	(102441,'Amplio','2003/03/27',false),	(194490,'Esencial','2003/07/13',false),	(179156,'Esencial','2014/06/28',true),	(179156,'Esencial','2014/06/28',true),	(179156,'Amplio Plus','2014/06/28',true),	(187973,'Basico','2015/06/19',true),	(45918,'Esencial','2019/03/24',true),	(112290,'Esencial','2020/09/21',true),	(75790,'Esencial','2007/06/06',true);


insert into  flota_keepcoding.marca (nombre_marca,id_modelo)
values ('Renault',11),	('Citroën',2),	('Nissan',3),	('Kia',9),	('Peugeot',8),	('Nissan',12),	('Kia',14),	('Renault',6),	('Dacia',13),	('Hyundai',15),	('Hyundai',5),	('Citroën',10),	('Peugeot',1),	('Renault',7),	('Dacia',4);

insert into flota_keepcoding.grupo (nombre_grupo, id_marca)
values ('Renault-Nissan-Mitsubishi Alliance',2),	('PSA Peugeot S.A.',3),	('Renault-Nissan-Mitsubishi Alliance',4),	('Hyundai Motor Group',5),	('PSA Peugeot S.A.',6),	('Renault-Nissan-Mitsubishi Alliance',10),	('Hyundai Motor Group',11);

insert into flota_keepcoding.vehiculos (matricula, num_chasis, kilometros, fecha_adquisicion, id_grupo, id_color)
values ('7343FRT',510803,47644,'2009/06/01',1,4),	('2438GSV',442284,52349,'2010/04/17',2,6),	('9666FZC',556817,39533,'2008/03/03',1,5),	('7221BJG',426457,70197,'1999/09/30',4,5),	('6756GXW',426511,112881,'2011/07/19',2,3),	('9314JHS',468948,41064,'2017/10/10',1,3),	('7987FXL',360414,24726,'2009/01/23',4,5),	('4325KMF',394359,49476,'2020/04/13',2,5),	('3883DSH',475311,35949,'2007/02/27',1,5),	('3242GQG',556337,77662,'2013/03/06',1,4),	('4315JKL',490168,46145,'2017/08/27',1,6),	('5426HDG',529821,46759,'2015/04/01',4,3),	('6231KKQ',447155,39563,'2019/04/10',1,4),	('7457BFT',559924,39949,'2000/11/24',1,3),	('5205DFJ',573549,50972,'2006/03/04',4,6),	('3212HJW',463829,28986,'2014/08/04',4,6),	('3313GGW',352454,35823,'2013/04/01',2,4),	('6642GZP',313089,97183,'2010/04/21',4,1),	('3306GYM',438359,76024,'2011/12/19',1,1),	('5303DCG',559254,35530,'2007/08/30',2,6),	('0827DBB',371882,39061,'2006/07/24',1,6),	('5047FJK',489068,90641,'2009/10/26',2,5),	('4366GZX',596037,44510,'2013/11/03',4,1),	('7561CND',429018,71901,'2004/09/22',4,5),	('5954DWX',499172,39775,'2007/10/25',1,3),	('9157JVM',386470,41539,'2017/09/18',2,5),	('0366CKQ',512479,118687,'2003/04/10',2,6),	('2907GNT',505159,51508,'2012/11/08',4,3),	('2428HYB',513133,87006,'2014/12/04',1,1),	('6743DYG',585773,76387,'2007/06/25',4,6),	('8706FTV',453600,53733,'2008/05/16',4,1),	('1567JPK',314697,54278,'2016/12/03',4,6),	('8802GQX',438111,34941,'2013/04/23',1,5),	('0922JVF',590221,97321,'2017/07/06',2,3),	('5022JZD',574005,63426,'2016/03/07',4,1),	('8177JPM',309675,77082,'2016/11/27',1,6),	('8627FRY',319298,30083,'2008/04/02',4,5),	('7938HXH',398036,53342,'2015/10/24',4,6),	('3230KTX',475169,69200,'2019/04/16',1,3),	('7710HMZ',300960,45773,'2014/04/09',2,1),	('4221JXR',460256,50166,'2018/03/19',4,2),	('3272JJJ',337239,27503,'2018/06/03',4,1),	('2633GJF',306827,41129,'2011/02/19',2,4),	('5648JTZ',329711,61124,'2016/04/14',4,1),	('1621CSY',474346,42218,'2004/10/12',2,4),	('9428BCQ',310970,33451,'2002/11/12',4,1),	('9412DTS',534903,54013,'2007/01/31',2,3),	('9729KXJ',490502,76972,'2020/09/06',1,1),	('2890DSR',447541,28530,'2006/07/13',4,6),	('2066BYF',580831,57697,'1999/03/14',2,6),	('7466DMG',488015,85722,'2007/03/31',1,6),	('0390DRK',538286,38651,'2007/03/27',2,1),	('6850KZW',363080,25227,'2020/05/11',4,5),	('3960JYB',327576,30810,'2017/09/15',1,3),	('9209KGR',470299,58260,'2020/03/02',2,4),	('1323DQL',556581,107492,'2006/01/22',1,3),	('2684FZV',524950,36859,'2008/05/10',2,3),	('6010JXB',371808,46520,'2017/06/30',4,3),	('9281BNK',433008,35517,'2002/04/06',4,6),	('0393DWY',391456,41340,'2007/08/02',2,4),	('7792CKF',399020,59984,'2003/03/02',4,1),	('7905HMT',537343,38622,'2015/10/31',4,2),	('3274CYM',333483,31210,'2004/03/13',1,3),	('5751FCL',378638,40662,'2008/07/30',4,4),	('9775BVC',583448,29962,'2001/03/14',4,6),	('3122DZN',334122,50250,'2007/12/01',1,5),	('7295DHG',349168,34938,'2006/10/17',1,2),	('2874BRD',398229,46794,'2000/10/01',4,2),	('8718CJT',590668,46682,'2005/08/23',1,3),	('8563JCM',344837,45745,'2017/10/11',1,2),	('6640FPQ',413615,38454,'2008/02/12',2,2),	('6788DRX',344097,36066,'2007/11/15',4,5),	('2430FDP',332286,91570,'2008/06/23',2,3),	('5851CSB',427358,39717,'2004/06/21',4,6),	('6708BTB',358957,44027,'2001/07/17',1,4),	('4916HJG',456497,64638,'2015/03/29',1,2),	('5899CLW',432866,35922,'2003/03/02',4,1),	('6016FWX',454633,27713,'2008/04/29',1,6),	('0007HHR',564178,37686,'2014/03/30',4,1),	('8540DXG',335445,27722,'2007/03/13',4,6),	('6335BFK',490699,53657,'1999/06/06',1,1),	('3187KKM',395100,69946,'2019/01/14',4,4),	('7631GCM',487974,31372,'2011/09/17',2,3),	('9024CVP',552917,25161,'2004/01/15',1,1),	('4761CVL',598703,35224,'2003/04/08',4,4),	('7489HBJ',589031,37783,'2014/10/11',1,4),	('5188DWK',575476,74494,'2007/12/07',4,2),	('7764GTD',504493,54522,'2012/10/01',4,1),	('7136BCS',471114,43363,'2001/02/09',2,5),	('2835JQN',301071,61510,'2016/11/16',1,4),	('4896HCC',421389,45887,'2014/05/19',1,3),	('5865JKB',585613,30495,'2016/01/24',4,2),	('8926GPQ',482349,42989,'2012/09/29',1,5),	('7224FDF',317098,28796,'2008/04/29',2,3),	('1970BLH',524132,47354,'2002/04/18',1,4),	('8217BCW',302008,43385,'2001/12/18',2,4),	('0326HRM',321773,105374,'2014/06/28',2,6),	('6532KNR',347325,35831,'2019/03/24',4,2),	('4389KSN',566838,30862,'2019/02/14',2,4),	('5572DHP',556513,42143,'2007/06/06',4,5);

insert into flota_keepcoding.compania_aseguradora (nombre_aseguradora, id_poliza, id_vehiculo)
values ('Allianz',1,1),	('Allianz',2,2),	('Axa',3,2),	('Allianz',4,3),	('Allianz',5,4),	('Mapfre',6,4),	('Mapfre',7,5),	('Mapfre',8,5),	('Mapfre',9,5),	('Generali',10,5),	('Allianz',11,6),	('Generali',12,7),	('Mapfre',13,8),	('Mapfre',14,9),	('Mapfre',15,10),	('Mapfre',16,10),	('Mapfre',17,10),	('Generali',18,10),	('Mapfre',19,11),	('Axa',20,12),	('Generali',21,12),	('Allianz',22,13),	('Mapfre',23,14),	('Allianz',24,15),	('Axa',25,16),	('Mapfre',26,17),	('Mapfre',27,18),	('Mapfre',28,18),	('Axa',29,18),	('Generali',30,19),	('Generali',31,19),	('Axa',32,19),	('Allianz',33,20),	('Generali',34,21),	('Mapfre',35,22),	('Mapfre',36,22),	('Mapfre',37,22),	('Axa',38,23),	('Mapfre',39,24),	('Mapfre',40,24),	('Mapfre',41,24),	('Allianz',42,25),	('Allianz',43,26),	('Axa',44,27),	('Axa',45,27),	('Axa',46,27),	('Allianz',47,27),	('Mapfre',48,28),	('Generali',49,29),	('Generali',50,29),	('Generali',51,29),	('Axa',52,29),	('Axa',53,30),	('Axa',54,30),	('Mapfre',55,30),	('Mapfre',56,31),	('Generali',57,32),	('Generali',58,33),	('Mapfre',59,34),	('Mapfre',60,34),	('Mapfre',61,34),	('Mapfre',62,35),	('Axa',63,35),	('Allianz',64,36),	('Allianz',65,36),	('Mapfre',66,36),	('Mapfre',67,37),	('Mapfre',68,38),	('Axa',69,38),	('Generali',70,39),	('Axa',71,39),	('Allianz',72,40),	('Generali',73,41),	('Generali',74,41),	('Mapfre',75,42),	('Mapfre',76,43),	('Allianz',77,44),	('Axa',78,44),	('Mapfre',79,45),	('Allianz',80,46),	('Generali',81,47),	('Allianz',82,48),	('Allianz',83,48),	('Generali',84,48),	('Allianz',85,49),	('Axa',86,50),	('Generali',87,50),	('Allianz',88,51),	('Allianz',89,51),	('Allianz',90,51),	('Axa',91,52),	('Mapfre',92,53),	('Mapfre',93,54),	('Generali',94,55),	('Axa',95,55),	('Mapfre',96,56),	('Mapfre',97,56),	('Mapfre',98,56),	('Generali',99,56),	('Mapfre',100,57),	('Mapfre',101,58),	('Mapfre',102,59),	('Allianz',103,60),	('Allianz',104,61),	('Mapfre',105,61),	('Axa',106,62),	('Axa',107,63),	('Allianz',108,64),	('Generali',109,65),	('Axa',110,66),	('Mapfre',111,67),	('Mapfre',112,68),	('Allianz',113,69),	('Mapfre',114,70),	('Axa',115,71),	('Axa',116,72),	('Generali',117,73),	('Generali',118,73),	('Generali',119,73),	('Generali',120,74),	('Generali',121,75),	('Axa',122,76),	('Axa',123,76),	('Allianz',124,76),	('Allianz',125,77),	('Mapfre',126,78),	('Allianz',127,79),	('Axa',128,80),	('Axa',129,81),	('Allianz',130,81),	('Generali',131,82),	('Generali',132,82),	('Allianz',133,82),	('Allianz',134,83),	('Allianz',135,84),	('Allianz',136,85),	('Axa',137,86),	('Axa',138,87),	('Axa',139,87),	('Generali',140,87),	('Generali',141,88),	('Allianz',142,88),	('Generali',143,89),	('Allianz',144,90),	('Allianz',145,90),	('Generali',146,91),	('Axa',147,92),	('Allianz',148,93),	('Mapfre',149,94),	('Generali',150,95),	('Mapfre',151,96),	('Axa',152,97),	('Axa',153,97),	('Axa',154,97),	('Generali',155,97),	('Generali',156,98),	('Axa',157,99),	('Axa',158,100);

insert into flota_keepcoding.mantenimientos (id_vehiculo, kilometraje, fecha_revision, valor_importe, id_moneda)
values (1,29564,'2020/07/07',1076032.5,2),	(2,12028,'2010/05/13',734.7,3),	(2,28312,'2016/05/17',460,4),	(3,19543,'2017/12/13',344330.4,2),	(4,12066,'2000/05/18',1162115.1,2),	(4,41764,'2008/05/24',800,4),	(5,21955,'2012/01/19',3615469.2,2),	(5,50738,'2012/04/02',697.5,3),	(5,74499,'2012/06/28',11869.2,1),	(5,94670,'2013/06/24',3579.6,1),	(6,24441,'2019/09/04',14695.2,1),	(7,11140,'2021/12/04',730,4),	(8,20410,'2022/07/08',7912.8,1),	(9,19245,'2014/05/16',570,4),	(10,16209,'2014/02/10',120.9,3),	(10,27845,'2014/04/27',80,4),	(10,38072,'2014/06/07',1695.6,1),	(10,49153,'2021/11/30',16767.6,1),	(11,20263,'2017/11/02',15825.6,1),	(12,16879,'2015/09/27',437.1,3),	(12,34964,'2019/08/24',2883767.1,2),	(13,13755,'2021/04/04',632.4,3),	(14,16226,'2018/09/24',90,4),	(15,23043,'2022/05/24',14883.6,1),	(16,14526,'2023/04/14',170,4),	(17,17187,'2017/12/13',1884.0,1),	(18,21563,'2011/01/06',3228097.5,2),	(18,49405,'2011/05/04',83.7,3),	(18,69454,'2023/03/11',1507.2,1),	(19,18060,'2012/04/17',1463404.2,2),	(19,37513,'2013/01/10',16767.6,1),	(19,58378,'2019/06/16',14883.6,1),	(20,14181,'2022/05/31',11492.4,1),	(21,24407,'2019/02/23',325.5,3),	(22,18053,'2010/02/22',5086.8,1),	(22,40390,'2010/05/03',399.9,3),	(22,63099,'2010/12/08',2324230.2,2),	(23,21132,'2017/08/27',306.9,3),	(24,13171,'2006/01/18',12622.8,1),	(24,29474,'2006/02/27',2926808.4,2),	(24,42110,'2021/04/19',74.4,3),	(25,25110,'2016/05/30',440,4),	(26,21421,'2020/12/29',390.6,3),	(27,24801,'2003/04/28',13941.6,1),	(27,51615,'2003/07/26',590,4),	(27,74997,'2004/04/27',83.7,3),	(27,90943,'2009/06/04',548.7,3),	(28,25366,'2016/03/09',753.3,3),	(29,17526,'2014/12/09',269.7,3),	(29,40875,'2015/09/05',610,4),	(29,59896,'2015/09/23',290,4),	(29,72001,'2016/05/24',399.9,3),	(30,22761,'2008/01/13',8101.2,1),	(30,34009,'2008/03/17',9608.4,1),	(30,60377,'2012/11/14',450,4),	(31,25843,'2011/12/07',3658510.5,2),	(32,28259,'2017/05/12',301289.1,2),	(33,22523,'2015/06/15',820,4),	(34,25300,'2018/11/25',602578.2,2),	(34,49167,'2018/12/06',6594.0,1),	(34,76863,'2023/05/08',8478.0,1),	(35,11715,'2016/05/13',430413.0,2),	(35,35020,'2021/04/19',539.4,3),	(36,19822,'2017/01/24',1678610.7,2),	(36,41924,'2017/11/25',483.6,3),	(36,57202,'2021/05/04',387371.7,2),	(37,16181,'2020/04/28',120.9,3),	(38,20157,'2016/09/08',186.0,3),	(38,34833,'2017/10/23',590,4),	(39,25879,'2019/05/13',4898.4,1),	(39,44068,'2023/02/02',688.2,3),	(40,22300,'2022/08/28',3391.2,1),	(41,18380,'2018/06/08',50,4),	(41,38809,'2022/05/22',204.6,3),	(42,11209,'2022/10/04',210,4),	(43,25614,'2023/07/13',3055932.3,2),	(44,22988,'2017/11/12',16390.8,1),	(44,47336,'2019/06/20',946908.6,2),	(45,29407,'2022/08/18',4898.4,1),	(46,14720,'2022/05/03',16956.0,1),	(47,24707,'2015/05/30',46.5,3),	(48,14348,'2020/10/11',110,4),	(48,36512,'2021/09/13',632.4,3),	(48,52881,'2022/04/12',3873717.0,2),	(49,13864,'2014/07/23',213.9,3),	(50,14097,'1999/09/04',1162115.1,2),	(50,28378,'2014/05/14',559536.9,2),	(51,19536,'2007/06/16',200,4),	(51,39863,'2007/09/26',325.5,3),	(51,56109,'2018/10/08',270,4),	(52,22339,'2015/12/01',6594.0,1),	(53,15206,'2023/03/05',10173.6,1),	(54,17211,'2018/08/22',158.1,3),	(55,12808,'2021/08/15',2637.6,1),	(55,31259,'2023/08/16',210,4),	(56,26924,'2006/02/11',3012891.0,2),	(56,49644,'2006/12/02',590,4),	(56,62371,'2007/01/03',3701551.8,2),	(56,90278,'2007/11/23',3572427.9,2),	(57,17713,'2008/06/07',455.7,3),	(58,19345,'2018/07/09',8854.8,1),	(59,15082,'2003/10/06',9043.2,1),	(60,22765,'2020/02/03',50,4),	(61,16746,'2003/05/06',560,4),	(61,37787,'2009/05/25',3830675.7,2),	(62,11937,'2020/07/14',590,4),	(63,17619,'2022/04/15',11869.2,1),	(64,16314,'2010/08/06',446.4,3),	(65,11436,'2001/04/27',1936858.5,2),	(66,27367,'2022/05/06',16202.4,1),	(67,20272,'2009/06/01',850,4),	(68,27678,'2021/12/22',232.5,3),	(69,25928,'2005/09/11',460,4),	(70,17322,'2018/05/24',720,4),	(71,14565,'2022/10/14',350,4),	(72,15306,'2015/12/29',840,4),	(73,29114,'2009/07/10',530,4),	(73,53723,'2009/08/21',3228097.5,2),	(73,66643,'2011/11/06',770,4),	(74,20756,'2011/03/09',780,4),	(75,27720,'2007/01/18',7347.6,1),	(76,17802,'2015/12/22',100,4),	(76,28533,'2015/12/27',516495.6,2),	(76,39243,'2023/08/26',46.5,3),	(77,18724,'2013/09/10',2109023.7,2),	(78,15657,'2014/02/25',817784.7,2),	(79,23034,'2021/02/22',817784.7,2),	(80,15249,'2014/01/12',530.1,3),	(81,19109,'1999/09/27',9985.2,1),	(81,34682,'2009/04/14',279.0,3),	(82,20293,'2019/12/20',602578.2,2),	(82,33325,'2020/01/25',1979899.8,2),	(82,43580,'2021/01/15',14318.4,1),	(83,15837,'2021/11/16',830,4),	(84,13470,'2014/03/18',2668560.6,2),	(85,21369,'2016/08/16',2109023.7,2),	(86,22207,'2019/08/02',316.2,3),	(87,23426,'2008/06/16',3572427.9,2),	(87,37800,'2008/09/25',670,4),	(87,60028,'2023/08/20',4898.4,1),	(88,16201,'2013/10/25',510,4),	(88,39865,'2015/03/30',1162115.1,2),	(89,22625,'2003/10/29',595.2,3),	(90,18893,'2018/05/05',1695.6,1),	(90,45588,'2021/08/01',669.6,3),	(91,27814,'2020/05/01',7536.0,1),	(92,11276,'2016/07/17',620,4),	(93,25569,'2016/11/01',330,4),	(94,16890,'2008/11/20',3228097.5,2),	(95,21660,'2010/04/07',2238147.6,2),	(96,25009,'2020/05/08',620,4),	(97,20625,'2015/05/30',827.7,3),	(97,46451,'2015/06/11',548.7,3),	(97,62529,'2015/06/18',350,4),	(97,90819,'2016/08/25',241.8,3),	(98,19344,'2022/03/26',13753.2,1),	(99,19885,'2021/12/06',559536.9,2),	(100,22437,'2014/05/29',186.0,3);


-- Crear la consulta

--consulta de mantenmientos e importes

select vehiculos.matricula, kilometraje, fecha_revision, valor_importe, moneda.nombre 
from flota_keepcoding.mantenimientos
inner join flota_keepcoding.moneda on mantenimientos.id_moneda = moneda.id_moneda
inner join flota_keepcoding.vehiculos on vehiculos.id = mantenimientos.id_vehiculo;

--consulta listado de coches activos en Keepcoding

select  grupo.nombre_grupo, marca.nombre_marca, modelo.nombre_modelo, vehiculos.fecha_adquisicion, vehiculos.matricula, vehiculos.num_chasis, color.nombre_color, vehiculos.kilometros, nombre_aseguradora, num_poliza
from flota_keepcoding.vehiculos
inner join flota_keepcoding.grupo on vehiculos.id_grupo = grupo.id_grupo
inner join flota_keepcoding.marca on grupo.id_marca = marca.id_marca
inner join flota_keepcoding.modelo on marca.id_modelo = modelo.id_modelo
inner join flota_keepcoding.color on vehiculos.id_color = color.id_color
inner join flota_keepcoding.compania_aseguradora on vehiculos.id = compania_aseguradora.id_vehiculo
inner join flota_keepcoding.poliza on compania_aseguradora.id_poliza = poliza.id_poliza
where poliza.vigencia_poliza = true; 





